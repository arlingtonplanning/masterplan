<!DOCTYPE html>
<meta charset="utf-8">

<html>
<head>
<title>Age of Housing Stock</title>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://dimplejs.org/dist/dimple.v2.1.6.min.js"></script>

<style>
body {
    background-color: rgb(252,245,223);
}
#BarChart {    
    float: left;
    top:5px;
	right:8px;
	width: 100%;
	height: 325px;
	background-color: rgb(252,245,223);
}
.textclasshead {
  float: center;
  font-family: 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif;
    font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 500;
	line-height: 15.4px;
  text-align: center;
  color: #545454;
  }
  .textclass {
  float: left;
  font-family: sans-serif;
    font-size: 12px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 18px;
  color: #545454;
  }
</style>
</head>
<body>
<div class="textclasshead">Typical Weekday Boardings on Bus Decades Through Arlington</div><br>
<div class="textclass">The chart shown here depicts general trends in weekday MBTA bus boardings along the bus routes that pass through Arlington . All data is from MBTA "blue books" and can be found online at <a href="http://www.mbta.com/about_the_mbta/document_library/?search=blue+book&submit_document_search=Search+Library"target="_blank">the MBTA's website</a>. Bus routes can be turned off by clicking the legend at the right. Data for years not documented was unobtainable. </div> 
<div id="BarChart"></div>
<div class="textclass"; width="100%"; height="400px";>According to the American Community Survey (ACS) 3,887 Arlington residents (16.7% of the population) commuted to work using public transit each day. The primary means of public transit in Arlington is MBTA bus service. The Alewife MBTA Station is not in Arlington, but is a short drive, walk, or bike ride for many residents.<br>Eleven MBTA bus routes run through Arlington. Most connect to the Red line via Alewife Station (#62, #67, #76, #79, #84, #350 buses) or
Harvard Station (#77 and #78 buses). The #80 and #87 buses connect to the Green Line at Lechmere Station; the #87 bus also connects to Davis Square Station. From Lechmere, the Green Line provides connections to Downtown Boston, Longwood area, Brookline, Brighton, and Newton, and Jamaica Plain. The #77 bus provides the most frequent service to the MBTA Red Line, leaving Arlington Heights with peak hour weekday service approximately every eight minutes and weekend service approximately every ten minutes. The #350 bus runs through Arlington between Alewife Station and Burlington, a major employment and retail center.</div>
    <script type="text/javascript">
//Start Bar Chart
var svgBar = dimple.newSvg("#BarChart", "92%", "95%");
    d3.csv("https://raw.githubusercontent.com/arlingtonplanning/masterplan/gh-pages/housing/AgeofHousingStock.csv", function (data) {
      dimple.filterData(data, "Municipality", ["Arlington", "Belmont", "Cambridge", "Lexington", "Medford", "Somerville", "Winchester", "Middlesex County", "Massachusetts"]);
var BarChart = new dimple.chart(svgBar, data);
      BarChart.setBounds("15%", "5%", "65%", "75%");
      var x = BarChart.addCategoryAxis("x", "Municipality");
      x.addOrderRule("Decade");
      BarChart.addMeasureAxis("y", "Percentage");
	  BarChartAxis.overrideMax = 100;
      var s = BarChart.addSeries("Decade", dimple.plot.bar);
	  s.addOrderRule("Decade");
      s.interpolation = "cardinal";
      s.lineMarkers = true;
	  s.lineWeight = 3; 
      var BarLegend = BarChart.addLegend ("90%", "10%", "10%", "90%", "right");
	  BarLegend.fontSize = "auto";
		var BarStoryboard = BarChart.setStoryboard("Decade");
		BarStoryboard.categoryFields = [null];
		BarChart.draw();
		BarStoryboard.storyLabel.remove();
        BarChart.legends = [];
        var filterValues = dimple.getUniqueValues(data, "Decade");
        BarLegend.shapes.selectAll("rect")
          .on("click", function (e) {
            var hide = false;
            var newFilters = [];
            filterValues.forEach(function (f) {
              if (f === e.aggField.slice(-1)[0]) {
                hide = true;
              } else {
                newFilters.push(f);
              }
            });
            if (hide) {
              d3.select(this).style("opacity", 0.2);
            } else {
              newFilters.push(e.aggField.slice(-1)[0]);
              d3.select(this).style("opacity", 0.8);
            }
            filterValues = newFilters;
            BarChart.data = dimple.filterData(data, "Decade", filterValues);
            BarChart.draw(800);
          });
		  
      });
  </script>
  </body>
  </html>